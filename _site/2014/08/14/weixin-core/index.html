<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>微信公众账号开发核心库</title>
    <link rel="fluid-icon" href="/fluidicon.png" />
    <link rel="apple-touch-icon" sizes="57x57" href="/images/apple-touch-icon-114.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-144.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/images/apple-touch-icon-144.png" />
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico" />
    <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
    <script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="/css/style.css" />
    <script type="text/javascript">
        $(function () {
            $(window).scroll(function () {
                var scrolltop = $(this).scrollTop();
                if (scrolltop >= 100) {
                    $("#elevator_item").show();
                } else {
                    $("#elevator_item").hide();
                }
            });
            $("#elevator").click(function () {
                $("html,body").animate({ scrollTop: 0 }, 500);
            });
            $(".qr").hover(function () {
                $(".qr-popup").show();
            }, function () {
                $(".qr-popup").hide();
            });
        });
    </script>
  </head>
  <body>
    <div class="container menu">
      <ul>
  <li><a href="/">博客</a></li>
  <li>/</li>
  <li><a href="https://github.com/WangWenzhuang">GitHub</a></li>
  <li>/</li>
  <li><a href="/about/">关于</a></li>
</ul>
    </div>
    <div class="container content">
	<h4 class="post-title">微信公众账号开发核心库</h4>
	<div class="post-title-line"></div>
	<div class="post-content">
	<h4 id="section">说明</h4>

<p>开发语言是 C#，大部分功能已经实现，简单易用。 </p>

<p><a href="https://github.com/wangwenzhuang">GitHub</a></p>

<p>如果需要看实现功能，可以扫描下面二维码，关注测试帐号。</p>

<p><img src="https://raw.githubusercontent.com/WangWenzhuang/WeiXin/master/OR.jpg" alt="扫一扫二维码" /></p>

<h4 id="section-1">快速使用</h4>

<p>1、实现 IWeiXinService 接口</p>

<pre><code>// 首先实现 IWeiXinService 接口
public class ProcessMessage : IWeiXinService
{
    /// &lt;summary&gt;
    /// 处理消息的接口，如果回复被动消息，直接回复 xml 格式的消息即可。
    /// 如果不处理或者发送客服消息等直接回复空字符串即可。
    /// &lt;/summary&gt;
    /// &lt;param name="receiveXmlMsgType"&gt;&lt;/param&gt;
    /// &lt;param name="receiveXmlMessage"&gt;&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    public string Process(ReceiveXmlMessageType receiveXmlMsgType, ReceiveXmlMessage receiveXmlMessage)
    {
        string result = string.Empty;
        if (receiveXmlMessage != null)
        {
            // 消息类型
            switch (receiveXmlMsgType)
            {
                case ReceiveXmlMessageType.Undefined:                          // 未识别出消息类型
                    break;
                case ReceiveXmlMessageType.Text:                               // 文本消息
                    break;
                case ReceiveXmlMessageType.Image:                              // 图片消息
                    break;
                case ReceiveXmlMessageType.Voice:                              // 语音消息
                    break;
                case ReceiveXmlMessageType.Video:                              // 视频消息
                    break;
                case ReceiveXmlMessageType.Location:                           // 地理位置消息
                    break;
                case ReceiveXmlMessageType.Link:                               // 链接消息
                    break;
                case ReceiveXmlMessageType.Event_QRCode_Subscribe:             // 用户未关注时扫描二维码事件
                    break;
                case ReceiveXmlMessageType.Event_QRCode_Scan:                  // 用户已关注时扫描二维码事件
                    break;
                case ReceiveXmlMessageType.Event_View:                         // 点击菜单跳转链接时事件
                    break;
                case ReceiveXmlMessageType.Event_Click:                        // 点击菜单拉取消息时事件
                    break;
                case ReceiveXmlMessageType.Event_Location:                     // 上报地理位置时事件
                    break;
                case ReceiveXmlMessageType.Event_Subscribe:                    // 关注事件
                    break;
                case ReceiveXmlMessageType.Event_UnSubscribe:                  // 取消关注事件
                    break;
                default:
                    break;
            }
        }
        return result;
    }
}
</code></pre>

<p>2、注册实现的接口</p>

<pre><code>WeiXinService.Register(_Service, appid, appsecret);
</code></pre>

<p>3、处理微信服务器发来的 xml</p>

<pre><code>WeiXinService.ProcessMessage(xml);
</code></pre>

	</div>
	<div class="post-time-line">
		分类：<span class="post-time-line-categories">技术</span>&nbsp;&nbsp;|&nbsp;&nbsp;
		<time datetime="2014-08-14">2014-08-14</time>
	</div>
	<!-- Duoshuo Comment BEGIN -->
<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"wangwenzhuang"};
(function() {
	var ds = document.createElement('script');
	ds.type = 'text/javascript';ds.async = true;
	ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
	ds.charset = 'UTF-8';
	(document.getElementsByTagName('head')[0] 
	 || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- Duoshuo Comment END -->
</div>
    <div class="container footer">
      <p>&copy;&nbsp;Copyright 2014 - 2015&nbsp;王文壮</p>
<p style="display:none"><script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_3431972'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s23.cnzz.com/stat.php%3Fid%3D3431972' type='text/javascript'%3E%3C/script%3E"));</script></p>
<div id="elevator_item">
    <a id="elevator" onclick="return false;" title="回到顶部"></a>
    <a class="qr"></a>
    <div class="qr-popup">
        <a class="code-link"><img class="code" src="/images/code.jpg" style="width:150px;height:150px;" /></a>
        <span>我的微信二维码</span>
        <div class="arr"></div>
    </div>
</div>

    </div>
  </body>
</html>
